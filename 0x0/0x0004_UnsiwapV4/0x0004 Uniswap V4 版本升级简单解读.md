---
创建时间: 2025-02-02 21:11
更新时间: 2025-02-03 11:15
---

Hello，大家好，我是Momo。作为一名区块链技术学习者，我将把学习过程中的心得整理成文章与大家分享。本文是0x0系列的第一篇，主要介绍区块链基础相关知识，欢迎志同道合的朋友一起交流讨论。

本系列所有代码和教程开源在Github - >【Web3-Learning】
![uniswap4.png](./img/uniswap4.png)

# 0x00 前言

2025年1月31日，Uniswap V4版本正式上线，带来了诸多重大改进与创新。此前，Momo已经详细讲解了Uniswap V2版本的相关内容。今天我Momo来简单探讨一下Uniswap V4在哪些方面进行了升级，接下来的链上交易能够带来哪些预期和改变。

# 0x01 两大创新点

## Hooks机制 + Custom Accounting（自定义会计）：

Hooks机制允许开发者在 Uniswap 的核心协议逻辑中插入自定义逻辑，增强了协议的灵活性和可扩展性。能够使接下来的链上交易能够更加灵活，更加多样化。
Custom Accounting（自定义会计）允许开发者通过挂钩（Hooks）机制，动态调整代币的数量或流动性管理规则，而不是完全依赖 Uniswap 的默认规则（恒定乘积公式x * y = k）。

![Pasted%20image%2020250202223024.png](./img/Pasted%20image%2020250202223024.png)

Momo觉得这一块的升级是Uniswap V4版本中最大的亮点，因为这一机制不仅为开发者提供了前所未有的灵活性，还为去中心化金融（DeFi）的未来发展开辟了无限可能。借助 Hooks，未来的链上池子将不再局限于简单的交易，而是可以将流动性池打造成复杂的金融产品或金融衍生品。结合当下热门的现实世界资产（RWA）、人工智能（AI）等趋势，Hooks 机制有望推动 DeFi 更加深入地替代传统金融。
为什么会这么说呢，我们拿之前微信小程序来看，微信小程序本质上是一个开发框架，凭借微信庞大的用户基础和强大的社交生态，开发者在这个平台上打造出了各种各样的应用场景和服务，从电商购物到金融服务，从游戏娱乐到生活服务，覆盖了人们生活的方方面面。同样地，Uniswap V4 的 Hooks 机制也为开发者提供了一个强大的底层框架，可以允许他们在这一基础上构建高度定制化的金融应用。


## 优化合约执行所需的Gas费用：

之前在主网执行交易的时候需要消耗大量的Gas，这个诟病使得交易成本非常的高。高昂的交易费用不仅限制了普通用户的参与，也阻碍了 DeFi 应用的大规模普及。然而，Uniswap V4 在这一次进行了大量的优化，使得交易成本大大降低。

- Singleton Design（单例设计）：V4 采用了一个单一的智能合约来管理所有流动性池，而不是像以前版本那样为每个池部署一个单独的合约。这种设计减少了合约部署和管理的复杂性，同时降低了 Gas 成本。
- Flash Accounting（闪存会计）：这里有的小伙伴翻译成闪电记账，Momo觉得翻译成闪存会计更合适，因为V4版本在交易执行合约过程中才用了EIP-1153 的瞬态存储（Transient Storage）功能，在多笔交易时所有的中间余额变化都记录在瞬态存储中，直到交易结束时才计算出最终的余额变化，再通过 SSTORE 写入持久化存储（即更新全局状态），这样一来，中间状态的写入和读取Gas成本被大幅降低。
- 原生 ETH 支持：V4版本在交易执行合约过程中，支持原生ETH的直接交易，用户无需将 ETH 转换为 ERC-20 代币，从而减少了交易步骤和相关费用。
![Pasted%20image%2020250202222907.png](./img/Pasted%20image%2020250202222907.png)

# 0x02 感想

2025 年新启，以太坊及其二层网络的进步将不仅仅局限于技术层面，更将体现在生态系统的繁荣和用户基础的扩大上。Uniswap选择在新年进行更新，Momo觉得这次更新将是 DeFi 领域的一个重要里程碑，也是以太坊迈向更广泛应用和更高效交易的重要一步。
